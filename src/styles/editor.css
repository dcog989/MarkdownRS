/* CodeMirror Editor Styling */

/* Base Editor Styling */
.cm-editor {
    background-color: var(--surface-1) !important;
    color: var(--text-primary) !important;
}

.cm-content {
    color: var(--text-primary) !important;
}

.cm-scroller {
    color: var(--text-primary) !important;
}

/* Prevent line numbers and gutters from being selectable */
.cm-gutters,
.cm-lineNumbers,
.cm-gutter,
.cm-gutterElement {
    user-select: none !important;
    -webkit-user-select: none !important;
    -moz-user-select: none !important;
    -ms-user-select: none !important;
}

/* Layout */
.cm-editor .cm-gutters {
    background-color: var(--surface-gutter) !important;
    border-right: 1px solid var(--border-primary) !important;
}

.cm-editor .cm-lineNumbers {
    min-width: 5ch !important;
}

.cm-editor .cm-gutterElement {
    display: flex !important;
    align-items: center;
    justify-content: flex-end;
    padding: 0 8px !important;
    color: var(--text-tertiary) !important;
}

.cm-editor .cm-activeLineGutter {
    background-color: var(--surface-2) !important;
    color: var(--text-primary) !important;
    font-weight: bold;
}

.cm-editor .cm-activeLine {
    background-color: var(--active-line-bg) !important;
}

.cm-editor.cm-focused .cm-selectionBackground,
.cm-editor .cm-selectionBackground,
.cm-editor .cm-content ::selection {
    background-color: var(--selection-bg) !important;
}

/* Prevent layout shift from special characters showing on selection */
.cm-selectionMatch {
    background-color: var(--selection-match-bg) !important;
}

/* Hide newline characters completely to prevent layout shift */
.cm-specialChar {
    display: none !important;
}

/* Prevent newline widget from causing layout shift */
.cm-newline {
    position: absolute;
    pointer-events: none;
    color: var(--text-tertiary);
    opacity: 0.5;
    font-size: 0.8em;
}

/* Syntax Highlighting - Structure & Variables */
.cm-h1,
.cm-h2,
.cm-h3,
.cm-h4,
.cm-h5,
.cm-h6 {
    color: var(--syntax-heading);
    font-weight: bold;
}
.cm-h1 {
    font-size: 1.3em;
}
.cm-h2 {
    font-size: 1.2em;
}
.cm-h3 {
    font-size: 1.1em;
}

.cm-keyword {
    color: var(--syntax-keyword);
}
.cm-atom,
.cm-number {
    color: var(--syntax-atom);
}
.cm-string {
    color: var(--syntax-string);
}
.cm-comment {
    color: var(--syntax-comment);
    font-style: italic;
}
.cm-emphasis {
    font-style: italic;
}
.cm-strong {
    font-weight: bold;
}

/* Interactive Elements */
.cm-link {
    color: var(--accent-link);
    text-decoration: underline;
}

.cm-url {
    color: var(--accent-url);
    text-decoration: underline;
}
.cm-url:hover {
    color: var(--accent-url-hover);
}

.cm-file-path {
    color: var(--accent-filepath);
    text-decoration: underline;
}
.cm-file-path:hover {
    color: var(--accent-filepath-hover);
}

/* Modifier Keys */
.cm-editor.cm-modifier-down {
    & .cm-url,
    & .cm-link,
    & .cm-file-path,
    & .cm-formatting-link-string {
        cursor: pointer !important;
    }

    & .cm-url:hover,
    & .cm-link:hover,
    & .cm-file-path:hover {
        background-color: oklch(from var(--accent-link) l c h / 0.1);
    }
}

/* Markdown Elements */
.cm-highlight {
    background-color: var(--highlight-bg);
    color: inherit;
}

.cm-strikethrough {
    text-decoration: line-through;
    text-decoration-color: var(--text-secondary);
}

.cm-code {
    background-color: var(--code-bg);
    color: var(--code-fg);
    border-radius: 0.25rem;
    font-variant-ligatures: none;
    box-decoration-break: clone;
    -webkit-box-decoration-break: clone;
}

.cm-formatting.cm-formatting-code,
.cm-formatting-code-marker,
.cm-meta.cm-code {
    background-color: var(--code-bg) !important;
    color: var(--code-fg) !important;
    border-radius: 0.25rem;
}

.cm-codeMark {
    background-color: transparent !important;
    color: var(--text-primary) !important;
    padding: 0 !important;
    border-radius: 0 !important;
    font-family: inherit !important;
}

.cm-blockquote {
    color: var(--text-secondary);
    font-style: italic;
}

.cm-blockquote-border {
    border-left: 0.25rem solid var(--quote-border);
    padding-left: 0.375rem;
    border-radius: 0.125rem 0 0 0.125rem;
}

.cm-blockquote-bg {
    background-color: var(--quote-bg);
    box-decoration-break: clone;
    -webkit-box-decoration-break: clone;
    padding-top: 0.0625rem;
    padding-bottom: 0.0625rem;
}

.cm-hr {
    color: var(--hr-color);
    font-weight: 900;
    display: block;
    text-align: center;
    opacity: 1;
    position: relative;
    padding: 0.12em 0;
}

.cm-hr::after {
    content: '';
    position: absolute;
    left: 0;
    right: 0;
    top: 50%;
    height: 2px;
    background-color: var(--border-secondary);
    opacity: 0.6;
    z-index: -1;
}

.cm-bullet {
    color: var(--accent-secondary);
    font-weight: 900;
    font-size: 1.1em;
}
